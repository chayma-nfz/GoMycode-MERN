{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\Nouveau dossier (2)\\\\ECommerce-MERN\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import moment from'moment';import{getOrders,getStatusValues,updateOrderStatus}from'../../helpers/adminFetch';import{isAuthenticated}from'../../helpers/authFetch';var Orders=function Orders(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),orders=_useState2[0],setOrders=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),statusValues=_useState4[0],setStatusValues=_useState4[1];var _isAuthenticated=isAuthenticated(),user=_isAuthenticated.user,token=_isAuthenticated.token;var loadOrders=function loadOrders(){getOrders(user._id,token).then(function(data){if(data.error){console.log(data.error);}else{// console.log(data);\nsetOrders(data);}});};useEffect(function(){//Get all orders\nloadOrders();//Get order's status\ngetStatusValues(user._id,token).then(function(data){if(data.error){console.log(data.error);}else{// console.log(data);\nsetStatusValues(data);}});// eslint-disable-next-line\n},[]);var showInput=function showInput(key,value){return React.createElement(\"div\",{className:\"input-group mb-2 mr-sm-2\"},React.createElement(\"div\",{className:\"input-group-prepend\"},React.createElement(\"div\",{className:\"input-group-text\"},key)),React.createElement(\"input\",{type:\"text\",value:value,className:\"form-control\",readOnly:true}));};var handleStatusChange=function handleStatusChange(e,orderId){updateOrderStatus(user._id,token,orderId,e.target.value).then(function(res){if(res.error){console.log('Status update failed');}else{loadOrders();}});};var showStatus=function showStatus(order){return React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"h4\",{className:\"mark mb-2\"},\"Status: \",order.status),React.createElement(\"select\",{className:\"form-control\",onChange:function onChange(e){return handleStatusChange(e,order._id);}},React.createElement(\"option\",null,\"Update Status\"),statusValues.map(function(status,i){return React.createElement(\"option\",{key:i,value:status},status);})));};return React.createElement(\"div\",null,React.createElement(\"h1\",{className:\"text-center mt-2 title\"},\"Total orders: \",orders.length),orders.map(function(o){return React.createElement(\"div\",{className:\"row m-2\",key:o._id},React.createElement(\"div\",{className:\"col-6\"},React.createElement(\"h4\",{className:\"mb-3 text-primary\"},React.createElement(\"span\",{className:\"\"},\"Order ID: \",o._id)),React.createElement(\"ul\",{className:\"list-group mb-2\"},React.createElement(\"li\",{className:\"list-group-item text-danger\"},showStatus(o)),React.createElement(\"li\",{className:\"list-group-item\"},\"Transaction ID: \",o.transaction_id),React.createElement(\"li\",{className:\"list-group-item\"},\"Amount: $\",o.amount),React.createElement(\"li\",{className:\"list-group-item\"},\"Ordered by: \",o.user.name),React.createElement(\"li\",{className:\"list-group-item\"},\"Ordered on: \",moment(o.createdAt).fromNow()),React.createElement(\"li\",{className:\"list-group-item\"},\"Delivery address: \",o.address))),React.createElement(\"div\",{className:\"col-6 m-auto\"},React.createElement(\"h3\",{className:\"mt-4 mb-4 font-italic\"},\"Total products in the order: \",o.products.length),o.products.map(function(p){return React.createElement(\"div\",{key:p._id},showInput('Name',p.name),showInput('Price',\"$\".concat(p.price)),showInput('Count',p.count),showInput('ID',p._id));})),React.createElement(\"hr\",{style:{borderBottom:'3px solid indigo',width:'50%'}}));}));};export default Orders;","map":{"version":3,"sources":["C:/Users/Admin/Desktop/Nouveau dossier (2)/ECommerce-MERN/client/src/components/AdminDashboard/Order.js"],"names":["React","useState","useEffect","moment","getOrders","getStatusValues","updateOrderStatus","isAuthenticated","Orders","orders","setOrders","statusValues","setStatusValues","user","token","loadOrders","_id","then","data","error","console","log","showInput","key","value","handleStatusChange","e","orderId","target","res","showStatus","order","status","map","i","length","o","transaction_id","amount","name","createdAt","fromNow","address","products","p","price","count","borderBottom","width"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport moment from 'moment';\nimport {\n  getOrders,\n  getStatusValues,\n  updateOrderStatus\n} from '../../helpers/adminFetch';\nimport { isAuthenticated } from '../../helpers/authFetch';\n\nconst Orders = () => {\n  const [orders, setOrders] = useState([]);\n  const [statusValues, setStatusValues] = useState([]);\n  const { user, token } = isAuthenticated();\n\n  const loadOrders = () => {\n    getOrders(user._id, token).then(data => {\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        // console.log(data);\n        setOrders(data);\n      }\n    });\n  };\n\n  useEffect(() => {\n    //Get all orders\n    loadOrders();\n\n    //Get order's status\n    getStatusValues(user._id, token).then(data => {\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        // console.log(data);\n        setStatusValues(data);\n      }\n    });\n    // eslint-disable-next-line\n  }, []);\n\n  const showInput = (key, value) => (\n    <div className=\"input-group mb-2 mr-sm-2\">\n      <div className=\"input-group-prepend\">\n        <div className=\"input-group-text\">{key}</div>\n      </div>\n      <input type=\"text\" value={value} className=\"form-control\" readOnly />\n    </div>\n  );\n\n  const handleStatusChange = (e, orderId) => {\n    updateOrderStatus(user._id, token, orderId, e.target.value).then(res => {\n      if (res.error) {\n        console.log('Status update failed');\n      } else {\n        loadOrders();\n      }\n    });\n  };\n  const showStatus = order => (\n    <div className=\"form-group\">\n      <h4 className=\"mark mb-2\">Status: {order.status}</h4>\n      <select\n        className=\"form-control\"\n        onChange={e => handleStatusChange(e, order._id)}\n      >\n        <option>Update Status</option>\n        {statusValues.map((status, i) => (\n          <option key={i} value={status}>\n            {status}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n\n  return (\n    <div>\n      <h1 className=\"text-center mt-2 title\">Total orders: {orders.length}</h1>\n      {orders.map(o => {\n        return (\n          <div className=\"row m-2\" key={o._id}>\n            <div className=\"col-6\">\n              <h4 className=\"mb-3 text-primary\">\n                <span className=\"\">Order ID: {o._id}</span>\n              </h4>\n\n              <ul className=\"list-group mb-2\">\n                <li className=\"list-group-item text-danger\">{showStatus(o)}</li>\n                <li className=\"list-group-item\">\n                  Transaction ID: {o.transaction_id}\n                </li>\n                <li className=\"list-group-item\">Amount: ${o.amount}</li>\n                <li className=\"list-group-item\">Ordered by: {o.user.name}</li>\n                <li className=\"list-group-item\">\n                  Ordered on: {moment(o.createdAt).fromNow()}\n                </li>\n                <li className=\"list-group-item\">\n                  Delivery address: {o.address}\n                </li>\n              </ul>\n            </div>\n            <div className=\"col-6 m-auto\">\n              <h3 className=\"mt-4 mb-4 font-italic\">\n                Total products in the order: {o.products.length}\n              </h3>\n              {o.products.map(p => (\n                <div key={p._id}>\n                  {showInput('Name', p.name)}\n                  {showInput('Price', `$${p.price}`)}\n                  {showInput('Count', p.count)}\n                  {showInput('ID', p._id)}\n                </div>\n              ))}\n            </div>\n            <hr style={{ borderBottom: '3px solid indigo', width: '50%' }} />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default Orders;\n"]},"metadata":{},"sourceType":"module"}