{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\Admin\\\\Desktop\\\\Nouveau dossier (2)\\\\ECommerce-MERN\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"C:\\\\Users\\\\Admin\\\\Desktop\\\\Nouveau dossier (2)\\\\ECommerce-MERN\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\Nouveau dossier (2)\\\\ECommerce-MERN\\\\client\\\\src\\\\components\\\\AdminDashboard\\\\UpdateProduct.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { getCategories, updateProduct, getProduct } from '../../helpers/adminFetch';\nimport { isAuthenticated } from '../../helpers/authFetch';\n\nconst UpdateProduct = ({\n  match\n}) => {\n  const _useState = useState({\n    name: '',\n    description: '',\n    price: '',\n    categories: [],\n    category: '',\n    shipping: '',\n    quantity: '',\n    photo: '',\n    loading: false,\n    error: '',\n    updatedProduct: '',\n    formData: ''\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        values = _useState2[0],\n        setValues = _useState2[1];\n\n  const _isAuthenticated = isAuthenticated(),\n        user = _isAuthenticated.user,\n        token = _isAuthenticated.token;\n\n  const name = values.name,\n        description = values.description,\n        price = values.price,\n        categories = values.categories,\n        quantity = values.quantity,\n        loading = values.loading,\n        error = values.error,\n        updatedProduct = values.updatedProduct,\n        formData = values.formData;\n\n  const loadProduct = productId => {\n    getProduct(productId).then(data => {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        // populate the state\n        setValues(_objectSpread({}, values, {\n          name: data.name,\n          description: data.description,\n          price: data.price,\n          category: data.category._id,\n          shipping: data.shipping,\n          quantity: data.quantity,\n          formData: new FormData()\n        })); // load categories\n\n        initCategories();\n      }\n    });\n  }; // load categories and set form data\n\n\n  const initCategories = () => {\n    getCategories().then(data => {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        setValues({\n          categories: data,\n          formData: new FormData()\n        });\n      }\n    });\n  };\n\n  useEffect(() => {\n    loadProduct(match.params.productId); // eslint-disable-next-line\n  }, []);\n\n  const handleChange = name => event => {\n    const value = name === 'photo' ? event.target.files[0] : event.target.value;\n    formData.set(name, value);\n    setValues(_objectSpread({}, values, {\n      [name]: value\n    }));\n  };\n\n  const clickSubmit = event => {\n    event.preventDefault();\n    setValues(_objectSpread({}, values, {\n      error: '',\n      loading: true\n    }));\n    updateProduct(user._id, token, match.params.productId, formData).then(data => {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        setValues(_objectSpread({}, values, {\n          name: '',\n          description: '',\n          photo: '',\n          price: '',\n          quantity: '',\n          loading: false,\n          updatedProduct: data.name\n        }));\n      }\n    });\n  };\n\n  const newPostForm = () => React.createElement(\"form\", {\n    className: \"mb-3\",\n    onSubmit: clickSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, \"Post Photo\"), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"btn btn-secondary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    onChange: handleChange('photo'),\n    type: \"file\",\n    name: \"photo\",\n    accept: \"image/*\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, \"Name\"), React.createElement(\"input\", {\n    onChange: handleChange('name'),\n    type: \"text\",\n    className: \"form-control\",\n    value: name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, \"Description\"), React.createElement(\"textarea\", {\n    onChange: handleChange('description'),\n    className: \"form-control\",\n    value: description,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, \"Price\"), React.createElement(\"input\", {\n    onChange: handleChange('price'),\n    type: \"number\",\n    className: \"form-control\",\n    value: price,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, \"Category\"), React.createElement(\"select\", {\n    onChange: handleChange('category'),\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, \"Please select\"), categories && categories.map((c, i) => React.createElement(\"option\", {\n    key: i,\n    value: c._id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, c.name)))), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, \"Shipping\"), React.createElement(\"select\", {\n    onChange: handleChange('shipping'),\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, \"Please select\"), React.createElement(\"option\", {\n    value: \"0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, \"No\"), React.createElement(\"option\", {\n    value: \"1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, \"Yes\"))), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, \"Quantity\"), React.createElement(\"input\", {\n    onChange: handleChange('quantity'),\n    type: \"number\",\n    className: \"form-control\",\n    value: quantity,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  })), React.createElement(Link, {\n    to: \"/admin/products\",\n    className: \"btn btn-outline-warning float-left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, \"Back\"), React.createElement(\"button\", {\n    className: \"btn btn-outline-primary float-right mb-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }, \"Update\"));\n\n  const showError = () => React.createElement(\"div\", {\n    className: \"alert alert-danger\",\n    style: {\n      display: error ? '' : 'none'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  }, error);\n\n  const showSuccess = () => React.createElement(\"div\", {\n    className: \"alert alert-info\",\n    style: {\n      display: updatedProduct ? '' : 'none'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }, `${updatedProduct}`, \" is updated successfully!\"));\n\n  const showLoading = () => loading && React.createElement(\"div\", {\n    className: \"d-flex justify-content-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"spinner-border\",\n    role: \"status\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"sr-only\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, \"Loading...\")));\n\n  return React.createElement(\"div\", {\n    className: \"container w-50\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    className: \"title p-2 text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, \"Update Product\"), showLoading(), showSuccess(), showError(), newPostForm());\n};\n\nexport default UpdateProduct;","map":{"version":3,"sources":["C:/Users/Admin/Desktop/Nouveau dossier (2)/ECommerce-MERN/client/src/components/AdminDashboard/UpdateProduct.js"],"names":["React","useState","useEffect","Link","getCategories","updateProduct","getProduct","isAuthenticated","UpdateProduct","match","name","description","price","categories","category","shipping","quantity","photo","loading","error","updatedProduct","formData","values","setValues","user","token","loadProduct","productId","then","data","_id","FormData","initCategories","params","handleChange","event","value","target","files","set","clickSubmit","preventDefault","newPostForm","map","c","i","showError","display","showSuccess","showLoading"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport {\n  getCategories,\n  updateProduct,\n  getProduct\n} from '../../helpers/adminFetch';\nimport { isAuthenticated } from '../../helpers/authFetch';\n\nconst UpdateProduct = ({ match }) => {\n  const [values, setValues] = useState({\n    name: '',\n    description: '',\n    price: '',\n    categories: [],\n    category: '',\n    shipping: '',\n    quantity: '',\n    photo: '',\n    loading: false,\n    error: '',\n    updatedProduct: '',\n\n    formData: ''\n  });\n\n  const { user, token } = isAuthenticated();\n  const {\n    name,\n    description,\n    price,\n    categories,\n    quantity,\n    loading,\n    error,\n    updatedProduct,\n    formData\n  } = values;\n\n  const loadProduct = productId => {\n    getProduct(productId).then(data => {\n      if (data.error) {\n        setValues({ ...values, error: data.error });\n      } else {\n        // populate the state\n        setValues({\n          ...values,\n          name: data.name,\n          description: data.description,\n          price: data.price,\n          category: data.category._id,\n          shipping: data.shipping,\n          quantity: data.quantity,\n          formData: new FormData()\n        });\n        // load categories\n        initCategories();\n      }\n    });\n  };\n\n  // load categories and set form data\n  const initCategories = () => {\n    getCategories().then(data => {\n      if (data.error) {\n        setValues({ ...values, error: data.error });\n      } else {\n        setValues({\n          categories: data,\n          formData: new FormData()\n        });\n      }\n    });\n  };\n\n  useEffect(() => {\n    loadProduct(match.params.productId);\n    // eslint-disable-next-line\n  }, []);\n\n  const handleChange = name => event => {\n    const value = name === 'photo' ? event.target.files[0] : event.target.value;\n    formData.set(name, value);\n    setValues({ ...values, [name]: value });\n  };\n\n  const clickSubmit = event => {\n    event.preventDefault();\n    setValues({ ...values, error: '', loading: true });\n\n    updateProduct(user._id, token, match.params.productId, formData).then(\n      data => {\n        if (data.error) {\n          setValues({ ...values, error: data.error });\n        } else {\n          setValues({\n            ...values,\n            name: '',\n            description: '',\n            photo: '',\n            price: '',\n            quantity: '',\n            loading: false,\n            updatedProduct: data.name\n          });\n        }\n      }\n    );\n  };\n\n  const newPostForm = () => (\n    <form className=\"mb-3\" onSubmit={clickSubmit}>\n      <h4>Post Photo</h4>\n      <div className=\"form-group\">\n        <label className=\"btn btn-secondary\">\n          <input\n            onChange={handleChange('photo')}\n            type=\"file\"\n            name=\"photo\"\n            accept=\"image/*\"\n          />\n        </label>\n      </div>\n\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Name</label>\n        <input\n          onChange={handleChange('name')}\n          type=\"text\"\n          className=\"form-control\"\n          value={name}\n        />\n      </div>\n\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Description</label>\n        <textarea\n          onChange={handleChange('description')}\n          className=\"form-control\"\n          value={description}\n        />\n      </div>\n\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Price</label>\n        <input\n          onChange={handleChange('price')}\n          type=\"number\"\n          className=\"form-control\"\n          value={price}\n        />\n      </div>\n\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Category</label>\n        <select onChange={handleChange('category')} className=\"form-control\">\n          <option>Please select</option>\n          {categories &&\n            categories.map((c, i) => (\n              <option key={i} value={c._id}>\n                {c.name}\n              </option>\n            ))}\n        </select>\n      </div>\n\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Shipping</label>\n        <select onChange={handleChange('shipping')} className=\"form-control\">\n          <option>Please select</option>\n          <option value=\"0\">No</option>\n          <option value=\"1\">Yes</option>\n        </select>\n      </div>\n\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Quantity</label>\n        <input\n          onChange={handleChange('quantity')}\n          type=\"number\"\n          className=\"form-control\"\n          value={quantity}\n        />\n      </div>\n\n      <Link to=\"/admin/products\" className=\"btn btn-outline-warning float-left\">\n        Back\n      </Link>\n      <button className=\"btn btn-outline-primary float-right mb-3\">\n        Update\n      </button>\n    </form>\n  );\n\n  const showError = () => (\n    <div\n      className=\"alert alert-danger\"\n      style={{ display: error ? '' : 'none' }}\n    >\n      {error}\n    </div>\n  );\n\n  const showSuccess = () => (\n    <div\n      className=\"alert alert-info\"\n      style={{ display: updatedProduct ? '' : 'none' }}\n    >\n      <h2>{`${updatedProduct}`} is updated successfully!</h2>\n    </div>\n  );\n\n  const showLoading = () =>\n    loading && (\n      <div className=\"d-flex justify-content-center\">\n        <div className=\"spinner-border\" role=\"status\">\n          <span className=\"sr-only\">Loading...</span>\n        </div>\n      </div>\n    );\n\n  return (\n    <div className=\"container w-50\">\n      <h1 className=\"title p-2 text-center\">Update Product</h1>\n      {showLoading()}\n      {showSuccess()}\n      {showError()}\n      {newPostForm()}\n    </div>\n  );\n};\n\nexport default UpdateProduct;\n"]},"metadata":{},"sourceType":"module"}